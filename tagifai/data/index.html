
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tag suggestions for projects on Made With ML.">
      
      
      
        <meta name="author" content="Goku Mohandas">
      
      
        <link rel="canonical" href="https://madewithml.com/tagifai/data/">
      
      <link rel="shortcut icon" href="../../static/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4">
    
    
      
        <title>Data - TagIfAI</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../static/css/custom.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tagifai.data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://madewithml.com/#mlops" title="TagIfAI" class="md-header-nav__button md-logo" aria-label="TagIfAI">
      
  <img src="../../static/images/logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            TagIfAI
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Data
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/GokuMohandas/MLOps" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GokuMohandas/MLOps
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../getting_started/" class="md-tabs__link">
      Getting started
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../app/api/" class="md-tabs__link md-tabs__link--active">
        Reference
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://madewithml.com/#mlops" title="TagIfAI" class="md-nav__button md-logo" aria-label="TagIfAI">
      
  <img src="../../static/images/logo.png" alt="logo">

    </a>
    TagIfAI
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/GokuMohandas/MLOps" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GokuMohandas/MLOps
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" data-md-state="indeterminate" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      Home
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Home" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Home
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      TagIfAI
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../getting_started/" class="md-nav__link">
      Getting started
    </a>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../app/api/" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../app/cli/" class="md-nav__link">
      CLI
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../app/config/" class="md-nav__link">
      Config
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Data
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Data
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tagifai.data" class="md-nav__link">
    tagifai.data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tagifai.data.CNNTextDataset" class="md-nav__link">
    CNNTextDataset
  </a>
  
    <nav class="md-nav" aria-label="CNNTextDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.LabelEncoder" class="md-nav__link">
    LabelEncoder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.MultiClassLabelEncoder" class="md-nav__link">
    MultiClassLabelEncoder
  </a>
  
    <nav class="md-nav" aria-label="MultiClassLabelEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.MultiLabelLabelEncoder" class="md-nav__link">
    MultiLabelLabelEncoder
  </a>
  
    <nav class="md-nav" aria-label="MultiLabelLabelEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.Stemmer" class="md-nav__link">
    Stemmer
  </a>
  
    <nav class="md-nav" aria-label="Stemmer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.Tokenizer" class="md-nav__link">
    Tokenizer
  </a>
  
    <nav class="md-nav" aria-label="Tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tagifai.data.filter_items" class="md-nav__link">
    filter_items()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.iterative_train_test_split" class="md-nav__link">
    iterative_train_test_split()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.pad_sequences" class="md-nav__link">
    pad_sequences()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.prepare" class="md-nav__link">
    prepare()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.preprocess" class="md-nav__link">
    preprocess()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../models/" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../train/" class="md-nav__link">
      Training
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../predict/" class="md-nav__link">
      Inference
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../utils/" class="md-nav__link">
      Utilities
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tagifai.data" class="md-nav__link">
    tagifai.data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tagifai.data.CNNTextDataset" class="md-nav__link">
    CNNTextDataset
  </a>
  
    <nav class="md-nav" aria-label="CNNTextDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.LabelEncoder" class="md-nav__link">
    LabelEncoder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.MultiClassLabelEncoder" class="md-nav__link">
    MultiClassLabelEncoder
  </a>
  
    <nav class="md-nav" aria-label="MultiClassLabelEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.MultiLabelLabelEncoder" class="md-nav__link">
    MultiLabelLabelEncoder
  </a>
  
    <nav class="md-nav" aria-label="MultiLabelLabelEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.Stemmer" class="md-nav__link">
    Stemmer
  </a>
  
    <nav class="md-nav" aria-label="Stemmer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.Tokenizer" class="md-nav__link">
    Tokenizer
  </a>
  
    <nav class="md-nav" aria-label="Tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    Methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tagifai.data.filter_items" class="md-nav__link">
    filter_items()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.iterative_train_test_split" class="md-nav__link">
    iterative_train_test_split()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.pad_sequences" class="md-nav__link">
    pad_sequences()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.prepare" class="md-nav__link">
    prepare()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tagifai.data.preprocess" class="md-nav__link">
    preprocess()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Data</h1>
                
                <div class="doc doc-object doc-module">
<h2 class="hidden-toc" id="tagifai.data" style="visibility: hidden; position: absolute;">
        </h2>
<div class="doc doc-contents first">
<div class="doc doc-children">
<h2 id="classes">Classes</h2>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="tagifai.data.CNNTextDataset">

        <code>CNNTextDataset</code>



      </h3>
<div class="doc doc-contents ">
<p>Create <code>torch.utils.data.Dataset</code> objects to use for
efficiently feeding data into our models.</p>
<p>Usage:</p>
<div class="highlight">
<pre><span></span><code><span class="c1"># Create dataset</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">CNNTextDataset</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">max_filter_size</span><span class="o">=</span><span class="n">max_filter_size</span><span class="p">)</span>

<span class="c1"># Create dataloaders</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">create_dataloader</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</code></pre>
</div>
<div class="doc doc-children">
<h4 id="methods">Methods</h4>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.CNNTextDataset.collate_fn">

<code class="highlight language-python"><span class="n">collate_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Processing on a batch. It's used to override the default <code>collate_fn</code> in <code>torch.utils.data.DataLoader</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>batch</code></td>
<td><code>List</code></td>
<td>
<p>List of inputs and outputs.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Tuple</code></td>
<td>
<p>Processed inputs and outputs.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">collate_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
    <span class="sd">"""Processing on a batch. It's used to override the default `collate_fn` in `torch.utils.data.DataLoader`.</span>

<span class="sd">    Args:</span>
<span class="sd">        batch (List): List of inputs and outputs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Processed inputs and outputs.</span>

<span class="sd">    """</span>
    <span class="c1"># Get inputs</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">batch</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Pad inputs</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">sequences</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_filter_size</span><span class="p">)</span>

    <span class="c1"># Cast</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.CNNTextDataset.create_dataloader">

<code class="highlight language-python"><span class="n">create_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Create dataloaders to load batches with.</p>
<p>Usage:</p>
<div class="highlight">
<pre><span></span><code><span class="c1"># Create dataset</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">CNNTextDataset</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">max_filter_size</span><span class="o">=</span><span class="n">max_filter_size</span><span class="p">)</span>

<span class="c1"># Create dataloaders</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">create_dataloader</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</code></pre>
</div>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>batch_size</code></td>
<td><code>int</code></td>
<td>
<p>Number of samples per batch.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>shuffle</code></td>
<td><code>bool</code></td>
<td>
<p>Shuffle each batch. Defaults to False.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>drop_last</code></td>
<td><code>bool</code></td>
<td>
<p>Drop the last batch if it's less than <code>batch_size</code>. Defaults to False.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DataLoader</code></td>
<td>
<p>Torch dataloader to load batches with.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_dataloader</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">drop_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">:</span>
    <span class="sd">"""Create dataloaders to load batches with.</span>

<span class="sd">    Usage:</span>

<span class="sd">    ```python</span>
<span class="sd">    # Create dataset</span>
<span class="sd">    X, y = data</span>
<span class="sd">    dataset = CNNTextDataset(X=X, y=y, max_filter_size=max_filter_size)</span>

<span class="sd">    # Create dataloaders</span>
<span class="sd">    dataloader = dataset.create_dataloader(batch_size=batch_size)</span>
<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        batch_size (int): Number of samples per batch.</span>
<span class="sd">        shuffle (bool, optional): Shuffle each batch. Defaults to False.</span>
<span class="sd">        drop_last (bool, optional): Drop the last batch if it's less than `batch_size`. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Torch dataloader to load batches with.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">dataset</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">collate_fn</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="n">shuffle</span><span class="p">,</span>
        <span class="n">drop_last</span><span class="o">=</span><span class="n">drop_last</span><span class="p">,</span>
        <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="tagifai.data.LabelEncoder">

        <code>LabelEncoder</code>



      </h3>
<div class="doc doc-contents ">
<p>Encode labels into unique indices.</p>
<p>Usage:</p>
<div class="highlight">
<pre><span></span><code><span class="c1"># Encode labels</span>
<span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">label_encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre>
</div>
<div class="doc doc-children">















  </div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="tagifai.data.MultiClassLabelEncoder">

        <code>MultiClassLabelEncoder</code>



      </h3>
<div class="doc doc-contents ">
<p>Encode labels into unique indices
for multi-class classification.</p>
<div class="doc doc-children">
<h4 id="methods_1">Methods</h4>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.MultiClassLabelEncoder.decode">

<code class="highlight language-python"><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Decode a collection of class indices.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>y</code></td>
<td><code>ndarray</code></td>
<td>
<p>Labels as (multilabel) one-hot encodings</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>List[List[str]]</code></td>
<td>
<p>List of original labels for each output.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="sd">"""Decode a collection of class indices.</span>

<span class="sd">    Args:</span>
<span class="sd">        y (np.ndarray): Labels as (multilabel) one-hot encodings</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of original labels for each output.</span>
<span class="sd">    """</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_to_class</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">classes</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.MultiClassLabelEncoder.encode">

<code class="highlight language-python"><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Encode a collection of classes.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>y</code></td>
<td><code>Series</code></td>
<td>
<p>Collection of labels as a pandas Series object.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ndarray</code></td>
<td>
<p>Labels as (multilabel) one-hot encodings</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">"""Encode a collection of classes.</span>

<span class="sd">    Args:</span>
<span class="sd">        y (pd.Series): Collection of labels as a pandas Series object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Labels as (multilabel) one-hot encodings</span>
<span class="sd">    """</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="n">encoded</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_index</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">encoded</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.MultiClassLabelEncoder.fit">

<code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Learn label mappings from a series of class labels.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>y</code></td>
<td><code>Sequence</code></td>
<td>
<p>Collection of labels as a pandas Series object.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">"""Learn label mappings from a series of class labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        y (Sequence): Collection of labels as a pandas Series object.</span>
<span class="sd">    """</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">class_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_to_index</span><span class="p">[</span><span class="n">class_</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_to_class</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_index</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_to_index</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="tagifai.data.MultiLabelLabelEncoder">

        <code>MultiLabelLabelEncoder</code>



      </h3>
<div class="doc doc-contents ">
<p>Encode labels into unique indices
for multi-label classification.</p>
<div class="doc doc-children">
<h4 id="methods_2">Methods</h4>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.MultiLabelLabelEncoder.decode">

<code class="highlight language-python"><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Decode a (multilabel) one-hot encoding into corresponding labels.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>y</code></td>
<td><code>ndarray</code></td>
<td>
<p>Labels as (multilabel) one-hot encodings</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>List[List[str]]</code></td>
<td>
<p>List of original labels for each output.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="sd">"""Decode a (multilabel) one-hot encoding into corresponding labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        y (np.ndarray): Labels as (multilabel) one-hot encodings</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of original labels for each output.</span>
<span class="sd">    """</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">index_to_class</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">classes</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.MultiLabelLabelEncoder.encode">

<code class="highlight language-python"><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Encode a collection of labels using (multilabel) one-hot encoding.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>y</code></td>
<td><code>Series</code></td>
<td>
<p>Collection of labels as a pandas Series object.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ndarray</code></td>
<td>
<p>Labels as (multilabel) one-hot encodings</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">"""Encode a collection of labels using (multilabel) one-hot encoding.</span>

<span class="sd">    Args:</span>
<span class="sd">        y (pd.Series): Collection of labels as a pandas Series object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Labels as (multilabel) one-hot encodings</span>
<span class="sd">    """</span>
    <span class="n">y_one_hot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_to_index</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">class_</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">y_one_hot</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">class_to_index</span><span class="p">[</span><span class="n">class_</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">y_one_hot</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.MultiLabelLabelEncoder.fit">

<code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Learn label mappings from a series of class labels.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>y</code></td>
<td><code>Sequence</code></td>
<td>
<p>Collection of labels as a pandas Series object.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">"""Learn label mappings from a series of class labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        y (Sequence): Collection of labels as a pandas Series object.</span>
<span class="sd">    """</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">class_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_to_index</span><span class="p">[</span><span class="n">class_</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_to_class</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_index</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_to_index</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="tagifai.data.Stemmer">

        <code>Stemmer</code>



      </h3>
<div class="doc doc-contents ">
<div class="doc doc-children">
<h4 id="methods_3">Methods</h4>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.Stemmer.stem">

<code class="highlight language-python"><span class="n">stem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Strip affixes from the token and return the stem.</p>
<p>:param token: The token that should be stemmed.
:type token: str</p>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">stem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NLTK_EXTENSIONS</span> <span class="ow">and</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">:</span>  <span class="c1"># pragma: no cover, nltk</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ORIGINAL_ALGORITHM</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># pragma: no cover, nltk</span>
        <span class="c1"># With this line, strings of length 1 or 2 don't go through</span>
        <span class="c1"># the stemming process, although no mention is made of this</span>
        <span class="c1"># in the published algorithm.</span>
        <span class="k">return</span> <span class="n">word</span>

    <span class="n">stem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step1a</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">stem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step1b</span><span class="p">(</span><span class="n">stem</span><span class="p">)</span>
    <span class="n">stem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step1c</span><span class="p">(</span><span class="n">stem</span><span class="p">)</span>
    <span class="n">stem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step2</span><span class="p">(</span><span class="n">stem</span><span class="p">)</span>
    <span class="n">stem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step3</span><span class="p">(</span><span class="n">stem</span><span class="p">)</span>
    <span class="n">stem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step4</span><span class="p">(</span><span class="n">stem</span><span class="p">)</span>
    <span class="n">stem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step5a</span><span class="p">(</span><span class="n">stem</span><span class="p">)</span>
    <span class="n">stem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step5b</span><span class="p">(</span><span class="n">stem</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">stem</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="tagifai.data.Tokenizer">

        <code>Tokenizer</code>



      </h3>
<div class="doc doc-contents ">
<p>Tokenize a feature using a built vocabulary.</p>
<p>Usage:</p>
<div class="highlight">
<pre><span></span><code><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">char_level</span><span class="o">=</span><span class="n">char_level</span><span class="p">)</span>
<span class="n">tokenizer</span><span class="o">.</span><span class="n">fit_on_texts</span><span class="p">(</span><span class="n">texts</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">texts_to_sequences</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</code></pre>
</div>
<div class="doc doc-children">
<h4 id="methods_4">Methods</h4>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.Tokenizer.fit_on_texts">

<code class="highlight language-python"><span class="n">fit_on_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Learn token mappings from a list of texts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>texts</code></td>
<td><code>List</code></td>
<td>
<p>List of texts made of tokens.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">fit_on_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
    <span class="sd">"""Learn token mappings from a list of texts.</span>

<span class="sd">    Args:</span>
<span class="sd">        texts (List): List of texts made of tokens.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">char_level</span><span class="p">:</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
    <span class="n">all_tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">all_tokens</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_tokens</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_token_freq</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">token</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token_to_index</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_to_token</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">token</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.Tokenizer.sequences_to_texts">

<code class="highlight language-python"><span class="n">sequences_to_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequences</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Convert a lists of arrays of indices to a list of texts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sequences</code></td>
<td><code>List</code></td>
<td>
<p>list of mapped tokens to convert back to text.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>List</code></td>
<td>
<p>Mapped text from index tokens.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">sequences_to_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequences</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
    <span class="sd">"""Convert a lists of arrays of indices to a list of texts.</span>

<span class="sd">    Args:</span>
<span class="sd">        sequences (List): list of mapped tokens to convert back to text.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Mapped text from index tokens.</span>
<span class="sd">    """</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_to_token</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oov_token</span><span class="p">))</span>
        <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">texts</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tagifai.data.Tokenizer.texts_to_sequences">

<code class="highlight language-python"><span class="n">texts_to_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">)</span></code>


      </h5>
<div class="doc doc-contents ">
<p>Convert a list of texts to a lists of arrays of indices.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>texts</code></td>
<td><code>List</code></td>
<td>
<p>List of texts to tokenize and map to indices.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>List[List]</code></td>
<td>
<p>A list of mapped sequences (list of indices).</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">texts_to_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">]:</span>
    <span class="sd">"""Convert a list of texts to a lists of arrays of indices.</span>

<span class="sd">    Args:</span>
<span class="sd">        texts (List): List of texts to tokenize and map to indices.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of mapped sequences (list of indices).</span>
<span class="sd">    """</span>
    <span class="n">sequences</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">char_level</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
            <span class="n">sequence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token_to_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_to_index</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">oov_token</span><span class="p">]))</span>
        <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sequences</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<h2 id="functions">Functions</h2>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="tagifai.data.filter_items">

<code class="highlight language-python"><span class="n">filter_items</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="p">[],</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[])</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Filter a list using inclusion and exclusion lists of items.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>items</code></td>
<td><code>List</code></td>
<td>
<p>List of items to apply filters.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>include</code></td>
<td><code>List</code></td>
<td>
<p>List of items to include. Defaults to [].</p>
</td>
<td><code>[]</code></td>
</tr>
<tr>
<td><code>exclude</code></td>
<td><code>List</code></td>
<td>
<p>List of items to filter out. Defaults to [].</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>List</code></td>
<td>
<p>Filtered list of items.</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight">
<pre><span></span><code><span class="c1"># Filter tags for each project</span>
<span class="n">df</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">filter_items</span><span class="p">,</span>
    <span class="n">include</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tags_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="n">exclude</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">EXCLDUE</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre>
</div>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">filter_items</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> <span class="n">include</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
    <span class="sd">"""Filter a list using inclusion and exclusion lists of items.</span>

<span class="sd">    Args:</span>
<span class="sd">        items (List): List of items to apply filters.</span>
<span class="sd">        include (List, optional): List of items to include. Defaults to [].</span>
<span class="sd">        exclude (List, optional): List of items to filter out. Defaults to [].</span>

<span class="sd">    Returns:</span>
<span class="sd">        Filtered list of items.</span>

<span class="sd">    Usage:</span>

<span class="sd">    ```python</span>
<span class="sd">    # Filter tags for each project</span>
<span class="sd">    df.tags = df.tags.apply(</span>
<span class="sd">        filter_items,</span>
<span class="sd">        include=list(tags_dict.keys()),</span>
<span class="sd">        exclude=config.EXCLDUE,</span>
<span class="sd">        )</span>
<span class="sd">    ```</span>

<span class="sd">    """</span>
    <span class="c1"># Filter</span>
    <span class="n">filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">include</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">filtered</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="tagifai.data.iterative_train_test_split">

<code class="highlight language-python"><span class="n">iterative_train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Custom iterative train test split which
'maintains balanced representation with respect
to order-th label combinations.'</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>X</code></td>
<td><code>Series</code></td>
<td>
<p>Input features as a pandas Series object.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>ndarray</code></td>
<td>
<p>One-hot encoded labels.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>train_size</code></td>
<td><code>float</code></td>
<td>
<p>Proportion of data for first split. Defaults to 0.7.</p>
</td>
<td><code>0.7</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Tuple</code></td>
<td>
<p>Two stratified splits based on specified proportions.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">iterative_train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">train_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
    <span class="sd">"""Custom iterative train test split which</span>
<span class="sd">    'maintains balanced representation with respect</span>
<span class="sd">    to order-th label combinations.'</span>

<span class="sd">    Args:</span>
<span class="sd">        X (pd.Series): Input features as a pandas Series object.</span>
<span class="sd">        y (np.ndarray): One-hot encoded labels.</span>
<span class="sd">        train_size (float, optional): Proportion of data for first split. Defaults to 0.7.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Two stratified splits based on specified proportions.</span>
<span class="sd">    """</span>
    <span class="n">stratifier</span> <span class="o">=</span> <span class="n">IterativeStratification</span><span class="p">(</span>
        <span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">sample_distribution_per_fold</span><span class="o">=</span><span class="p">[</span>
            <span class="mf">1.0</span> <span class="o">-</span> <span class="n">train_size</span><span class="p">,</span>
            <span class="n">train_size</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">stratifier</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">train_indices</span><span class="p">]</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">test_indices</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="tagifai.data.pad_sequences">

<code class="highlight language-python"><span class="n">pad_sequences</span><span class="p">(</span><span class="n">sequences</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Zero pad sequences to a specified <code>max_seq_len</code>
or to the length of the largest sequence in <code>sequences</code>.</p>
<p>Usage:</p>
<div class="highlight">
<pre><span></span><code><span class="c1"># Pad inputs</span>
<span class="n">seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="n">padded_seq</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">sequences</span><span class="o">=</span><span class="n">seq</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">padded_seq</span><span class="p">)</span>
</code></pre>
</div>
<pre>
[[1. 2. 3. 0. 0.]
 [1. 2. 0. 0. 0.]]
</pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Input <code>sequences</code> must be 2D.
Check out this <a href="https://madewithml.com/courses/foundations/convolutional-neural-networks/#padding" target="_blank">implemention</a> for a more generalized approach.</p>
</div>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sequences</code></td>
<td><code>ndarray</code></td>
<td>
<p>2D array of data to be padded.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>max_seq_len</code></td>
<td><code>int</code></td>
<td>
<p>Length to pad sequences to. Defaults to 0.</p>
</td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>Input sequences are not two-dimensional.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ndarray</code></td>
<td>
<p>An array with the zero padded sequences.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">pad_sequences</span><span class="p">(</span><span class="n">sequences</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">"""Zero pad sequences to a specified `max_seq_len`</span>
<span class="sd">    or to the length of the largest sequence in `sequences`.</span>

<span class="sd">    Usage:</span>

<span class="sd">    ```python</span>
<span class="sd">    # Pad inputs</span>
<span class="sd">    seq = np.array([[1, 2, 3], [1, 2]], dtype=object)</span>
<span class="sd">    padded_seq = pad_sequences(sequences=seq, max_seq_len=5)</span>
<span class="sd">    print (padded_seq)</span>
<span class="sd">    ```</span>
<span class="sd">    &lt;pre&gt;</span>
<span class="sd">    [[1. 2. 3. 0. 0.]</span>
<span class="sd">     [1. 2. 0. 0. 0.]]</span>
<span class="sd">    &lt;/pre&gt;</span>

<span class="sd">    Note:</span>
<span class="sd">        Input `sequences` must be 2D.</span>
<span class="sd">        Check out this [implemention](https://madewithml.com/courses/foundations/convolutional-neural-networks/#padding){:target="_blank"} for a more generalized approach.</span>

<span class="sd">    Args:</span>
<span class="sd">        sequences (np.ndarray): 2D array of data to be padded.</span>
<span class="sd">        max_seq_len (int, optional): Length to pad sequences to. Defaults to 0.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Input sequences are not two-dimensional.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An array with the zero padded sequences.</span>

<span class="sd">    """</span>
    <span class="c1"># Get max sequence length</span>
    <span class="n">max_seq_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_seq_len</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">))</span>

    <span class="c1"># Pad</span>
    <span class="n">padded_sequences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sequences</span><span class="p">),</span> <span class="n">max_seq_len</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sequences</span><span class="p">):</span>
        <span class="n">padded_sequences</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)]</span> <span class="o">=</span> <span class="n">sequence</span>
    <span class="k">return</span> <span class="n">padded_sequences</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="tagifai.data.prepare">

<code class="highlight language-python"><span class="n">prepare</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="p">[],</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_tag_freq</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Prepare the raw data.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>df</code></td>
<td><code>DataFrame</code></td>
<td>
<p>Pandas DataFrame with data.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>include</code></td>
<td><code>List</code></td>
<td>
<p>list of tags to include.</p>
</td>
<td><code>[]</code></td>
</tr>
<tr>
<td><code>exclude</code></td>
<td><code>List</code></td>
<td>
<p>list of tags to exclude.</p>
</td>
<td><code>[]</code></td>
</tr>
<tr>
<td><code>min_tag_freq</code></td>
<td><code>int</code></td>
<td>
<p>Minimum frequency of tags required. Defaults to 30.</p>
</td>
<td><code>30</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Tuple</code></td>
<td>
<p>A cleaned dataframe and dictionary of tags and counts above the frequency threshold.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">include</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">min_tag_freq</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
    <span class="sd">"""Prepare the raw data.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Pandas DataFrame with data.</span>
<span class="sd">        include (List): list of tags to include.</span>
<span class="sd">        exclude (List): list of tags to exclude.</span>
<span class="sd">        min_tag_freq (int, optional): Minimum frequency of tags required. Defaults to 30.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A cleaned dataframe and dictionary of tags and counts above the frequency threshold.</span>
<span class="sd">    """</span>
    <span class="c1"># Filter tags for each project</span>
    <span class="n">df</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_items</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>

    <span class="c1"># Filter tags that have fewer than `min_tag_freq` occurrences</span>
    <span class="n">tags_above_freq</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">tag</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="o">.</span><span class="n">elements</span><span class="p">()</span> <span class="k">if</span> <span class="n">tags</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_tag_freq</span><span class="p">)</span>
    <span class="n">tags_below_freq</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">tag</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="o">.</span><span class="n">elements</span><span class="p">()</span> <span class="k">if</span> <span class="n">tags</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_tag_freq</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_items</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tags_above_freq</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

    <span class="c1"># Remove projects with no more remaining relevant tags</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">tags_above_freq</span><span class="p">,</span> <span class="n">tags_below_freq</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="tagifai.data.preprocess">

<code class="highlight language-python"><span class="n">preprocess</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stem</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="s1">'[!</span><span class="se">\\</span><span class="s1">"</span><span class="se">\'</span><span class="s1">#$%&amp;()*</span><span class="se">\\</span><span class="s1">+,-./:;&lt;=&gt;?@</span><span class="se">\\\\\\</span><span class="s1">[</span><span class="se">\\</span><span class="s1">]^_`{|}~]'</span><span class="p">,</span> <span class="n">stopwords</span><span class="o">=</span><span class="p">[</span><span class="s1">'i'</span><span class="p">,</span> <span class="s1">'me'</span><span class="p">,</span> <span class="s1">'my'</span><span class="p">,</span> <span class="s1">'myself'</span><span class="p">,</span> <span class="s1">'we'</span><span class="p">,</span> <span class="s1">'our'</span><span class="p">,</span> <span class="s1">'ours'</span><span class="p">,</span> <span class="s1">'ourselves'</span><span class="p">,</span> <span class="s1">'you'</span><span class="p">,</span> <span class="s2">"you're"</span><span class="p">,</span> <span class="s2">"you've"</span><span class="p">,</span> <span class="s2">"you'll"</span><span class="p">,</span> <span class="s2">"you'd"</span><span class="p">,</span> <span class="s1">'your'</span><span class="p">,</span> <span class="s1">'yours'</span><span class="p">,</span> <span class="s1">'yourself'</span><span class="p">,</span> <span class="s1">'yourselves'</span><span class="p">,</span> <span class="s1">'he'</span><span class="p">,</span> <span class="s1">'him'</span><span class="p">,</span> <span class="s1">'his'</span><span class="p">,</span> <span class="s1">'himself'</span><span class="p">,</span> <span class="s1">'she'</span><span class="p">,</span> <span class="s2">"she's"</span><span class="p">,</span> <span class="s1">'her'</span><span class="p">,</span> <span class="s1">'hers'</span><span class="p">,</span> <span class="s1">'herself'</span><span class="p">,</span> <span class="s1">'it'</span><span class="p">,</span> <span class="s2">"it's"</span><span class="p">,</span> <span class="s1">'its'</span><span class="p">,</span> <span class="s1">'itself'</span><span class="p">,</span> <span class="s1">'they'</span><span class="p">,</span> <span class="s1">'them'</span><span class="p">,</span> <span class="s1">'their'</span><span class="p">,</span> <span class="s1">'theirs'</span><span class="p">,</span> <span class="s1">'themselves'</span><span class="p">,</span> <span class="s1">'what'</span><span class="p">,</span> <span class="s1">'which'</span><span class="p">,</span> <span class="s1">'who'</span><span class="p">,</span> <span class="s1">'whom'</span><span class="p">,</span> <span class="s1">'this'</span><span class="p">,</span> <span class="s1">'that'</span><span class="p">,</span> <span class="s2">"that'll"</span><span class="p">,</span> <span class="s1">'these'</span><span class="p">,</span> <span class="s1">'those'</span><span class="p">,</span> <span class="s1">'am'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">,</span> <span class="s1">'was'</span><span class="p">,</span> <span class="s1">'were'</span><span class="p">,</span> <span class="s1">'be'</span><span class="p">,</span> <span class="s1">'been'</span><span class="p">,</span> <span class="s1">'being'</span><span class="p">,</span> <span class="s1">'have'</span><span class="p">,</span> <span class="s1">'has'</span><span class="p">,</span> <span class="s1">'had'</span><span class="p">,</span> <span class="s1">'having'</span><span class="p">,</span> <span class="s1">'do'</span><span class="p">,</span> <span class="s1">'does'</span><span class="p">,</span> <span class="s1">'did'</span><span class="p">,</span> <span class="s1">'doing'</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">,</span> <span class="s1">'an'</span><span class="p">,</span> <span class="s1">'the'</span><span class="p">,</span> <span class="s1">'and'</span><span class="p">,</span> <span class="s1">'but'</span><span class="p">,</span> <span class="s1">'if'</span><span class="p">,</span> <span class="s1">'or'</span><span class="p">,</span> <span class="s1">'because'</span><span class="p">,</span> <span class="s1">'as'</span><span class="p">,</span> <span class="s1">'until'</span><span class="p">,</span> <span class="s1">'while'</span><span class="p">,</span> <span class="s1">'of'</span><span class="p">,</span> <span class="s1">'at'</span><span class="p">,</span> <span class="s1">'by'</span><span class="p">,</span> <span class="s1">'for'</span><span class="p">,</span> <span class="s1">'with'</span><span class="p">,</span> <span class="s1">'about'</span><span class="p">,</span> <span class="s1">'against'</span><span class="p">,</span> <span class="s1">'between'</span><span class="p">,</span> <span class="s1">'into'</span><span class="p">,</span> <span class="s1">'through'</span><span class="p">,</span> <span class="s1">'during'</span><span class="p">,</span> <span class="s1">'before'</span><span class="p">,</span> <span class="s1">'after'</span><span class="p">,</span> <span class="s1">'above'</span><span class="p">,</span> <span class="s1">'below'</span><span class="p">,</span> <span class="s1">'to'</span><span class="p">,</span> <span class="s1">'from'</span><span class="p">,</span> <span class="s1">'up'</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">,</span> <span class="s1">'in'</span><span class="p">,</span> <span class="s1">'out'</span><span class="p">,</span> <span class="s1">'on'</span><span class="p">,</span> <span class="s1">'off'</span><span class="p">,</span> <span class="s1">'over'</span><span class="p">,</span> <span class="s1">'under'</span><span class="p">,</span> <span class="s1">'again'</span><span class="p">,</span> <span class="s1">'further'</span><span class="p">,</span> <span class="s1">'then'</span><span class="p">,</span> <span class="s1">'once'</span><span class="p">,</span> <span class="s1">'here'</span><span class="p">,</span> <span class="s1">'there'</span><span class="p">,</span> <span class="s1">'when'</span><span class="p">,</span> <span class="s1">'where'</span><span class="p">,</span> <span class="s1">'why'</span><span class="p">,</span> <span class="s1">'how'</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span> <span class="s1">'both'</span><span class="p">,</span> <span class="s1">'each'</span><span class="p">,</span> <span class="s1">'few'</span><span class="p">,</span> <span class="s1">'more'</span><span class="p">,</span> <span class="s1">'most'</span><span class="p">,</span> <span class="s1">'other'</span><span class="p">,</span> <span class="s1">'some'</span><span class="p">,</span> <span class="s1">'such'</span><span class="p">,</span> <span class="s1">'no'</span><span class="p">,</span> <span class="s1">'nor'</span><span class="p">,</span> <span class="s1">'not'</span><span class="p">,</span> <span class="s1">'only'</span><span class="p">,</span> <span class="s1">'own'</span><span class="p">,</span> <span class="s1">'same'</span><span class="p">,</span> <span class="s1">'so'</span><span class="p">,</span> <span class="s1">'than'</span><span class="p">,</span> <span class="s1">'too'</span><span class="p">,</span> <span class="s1">'very'</span><span class="p">,</span> <span class="s1">'s'</span><span class="p">,</span> <span class="s1">'t'</span><span class="p">,</span> <span class="s1">'can'</span><span class="p">,</span> <span class="s1">'will'</span><span class="p">,</span> <span class="s1">'just'</span><span class="p">,</span> <span class="s1">'don'</span><span class="p">,</span> <span class="s2">"don't"</span><span class="p">,</span> <span class="s1">'should'</span><span class="p">,</span> <span class="s2">"should've"</span><span class="p">,</span> <span class="s1">'now'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">,</span> <span class="s1">'ll'</span><span class="p">,</span> <span class="s1">'m'</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="s1">'re'</span><span class="p">,</span> <span class="s1">'ve'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="s1">'ain'</span><span class="p">,</span> <span class="s1">'aren'</span><span class="p">,</span> <span class="s2">"aren't"</span><span class="p">,</span> <span class="s1">'couldn'</span><span class="p">,</span> <span class="s2">"couldn't"</span><span class="p">,</span> <span class="s1">'didn'</span><span class="p">,</span> <span class="s2">"didn't"</span><span class="p">,</span> <span class="s1">'doesn'</span><span class="p">,</span> <span class="s2">"doesn't"</span><span class="p">,</span> <span class="s1">'hadn'</span><span class="p">,</span> <span class="s2">"hadn't"</span><span class="p">,</span> <span class="s1">'hasn'</span><span class="p">,</span> <span class="s2">"hasn't"</span><span class="p">,</span> <span class="s1">'haven'</span><span class="p">,</span> <span class="s2">"haven't"</span><span class="p">,</span> <span class="s1">'isn'</span><span class="p">,</span> <span class="s2">"isn't"</span><span class="p">,</span> <span class="s1">'ma'</span><span class="p">,</span> <span class="s1">'mightn'</span><span class="p">,</span> <span class="s2">"mightn't"</span><span class="p">,</span> <span class="s1">'mustn'</span><span class="p">,</span> <span class="s2">"mustn't"</span><span class="p">,</span> <span class="s1">'needn'</span><span class="p">,</span> <span class="s2">"needn't"</span><span class="p">,</span> <span class="s1">'shan'</span><span class="p">,</span> <span class="s2">"shan't"</span><span class="p">,</span> <span class="s1">'shouldn'</span><span class="p">,</span> <span class="s2">"shouldn't"</span><span class="p">,</span> <span class="s1">'wasn'</span><span class="p">,</span> <span class="s2">"wasn't"</span><span class="p">,</span> <span class="s1">'weren'</span><span class="p">,</span> <span class="s2">"weren't"</span><span class="p">,</span> <span class="s1">'won'</span><span class="p">,</span> <span class="s2">"won't"</span><span class="p">,</span> <span class="s1">'wouldn'</span><span class="p">,</span> <span class="s2">"wouldn't"</span><span class="p">])</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Conditional preprocessing on text.</p>
<p>Usage:</p>
<div class="highlight">
<pre><span></span><code><span class="n">preprocess</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">"Transfer learning with BERT!"</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stem</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre>
</div>
<pre>
'transfer learn bert'
</pre>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>text</code></td>
<td><code>str</code></td>
<td>
<p>String to preprocess.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>lower</code></td>
<td><code>bool</code></td>
<td>
<p>Lower the text. Defaults to True.</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>stem</code></td>
<td><code>bool</code></td>
<td>
<p>Stem the text. Defaults to False.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>filters</code></td>
<td><code>str</code></td>
<td>
<p>Filters to apply on text.</p>
</td>
<td><code>'[!\\"\'#$%&amp;()*\\+,-./:;&lt;=&gt;?@\\\\\\[\\]^_`{|}~]'</code></td>
</tr>
<tr>
<td><code>stopwords</code></td>
<td><code>List</code></td>
<td>
<p>List of words to filter out. Defaults to STOPWORDS.</p>
</td>
<td><code>['i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', "you're", "you've", "you'll", "you'd", 'your', 'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', "she's", 'her', 'hers', 'herself', 'it', "it's", 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves', 'what', 'which', 'who', 'whom', 'this', 'that', "that'll", 'these', 'those', 'am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'having', 'do', 'does', 'did', 'doing', 'a', 'an', 'the', 'and', 'but', 'if', 'or', 'because', 'as', 'until', 'while', 'of', 'at', 'by', 'for', 'with', 'about', 'against', 'between', 'into', 'through', 'during', 'before', 'after', 'above', 'below', 'to', 'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under', 'again', 'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why', 'how', 'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some', 'such', 'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very', 's', 't', 'can', 'will', 'just', 'don', "don't", 'should', "should've", 'now', 'd', 'll', 'm', 'o', 're', 've', 'y', 'ain', 'aren', "aren't", 'couldn', "couldn't", 'didn', "didn't", 'doesn', "doesn't", 'hadn', "hadn't", 'hasn', "hasn't", 'haven', "haven't", 'isn', "isn't", 'ma', 'mightn', "mightn't", 'mustn', "mustn't", 'needn', "needn't", 'shan', "shan't", 'shouldn', "shouldn't", 'wasn', "wasn't", 'weren', "weren't", 'won', "won't", 'wouldn', "wouldn't"]</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>str</code></td>
<td>
<p>Preprocessed string.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tagifai/data.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">lower</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">stem</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"[!</span><span class="se">\"</span><span class="s2">'#$%&amp;()*\+,-./:;&lt;=&gt;?@</span><span class="se">\\</span><span class="s2">\[\]^_`{|}~]"</span><span class="p">,</span>
    <span class="n">stopwords</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"i"</span><span class="p">,</span>
        <span class="s2">"me"</span><span class="p">,</span>
        <span class="s2">"my"</span><span class="p">,</span>
        <span class="s2">"myself"</span><span class="p">,</span>
        <span class="s2">"we"</span><span class="p">,</span>
        <span class="s2">"our"</span><span class="p">,</span>
        <span class="s2">"ours"</span><span class="p">,</span>
        <span class="s2">"ourselves"</span><span class="p">,</span>
        <span class="s2">"you"</span><span class="p">,</span>
        <span class="s2">"you're"</span><span class="p">,</span>
        <span class="s2">"you've"</span><span class="p">,</span>
        <span class="s2">"you'll"</span><span class="p">,</span>
        <span class="s2">"you'd"</span><span class="p">,</span>
        <span class="s2">"your"</span><span class="p">,</span>
        <span class="s2">"yours"</span><span class="p">,</span>
        <span class="s2">"yourself"</span><span class="p">,</span>
        <span class="s2">"yourselves"</span><span class="p">,</span>
        <span class="s2">"he"</span><span class="p">,</span>
        <span class="s2">"him"</span><span class="p">,</span>
        <span class="s2">"his"</span><span class="p">,</span>
        <span class="s2">"himself"</span><span class="p">,</span>
        <span class="s2">"she"</span><span class="p">,</span>
        <span class="s2">"she's"</span><span class="p">,</span>
        <span class="s2">"her"</span><span class="p">,</span>
        <span class="s2">"hers"</span><span class="p">,</span>
        <span class="s2">"herself"</span><span class="p">,</span>
        <span class="s2">"it"</span><span class="p">,</span>
        <span class="s2">"it's"</span><span class="p">,</span>
        <span class="s2">"its"</span><span class="p">,</span>
        <span class="s2">"itself"</span><span class="p">,</span>
        <span class="s2">"they"</span><span class="p">,</span>
        <span class="s2">"them"</span><span class="p">,</span>
        <span class="s2">"their"</span><span class="p">,</span>
        <span class="s2">"theirs"</span><span class="p">,</span>
        <span class="s2">"themselves"</span><span class="p">,</span>
        <span class="s2">"what"</span><span class="p">,</span>
        <span class="s2">"which"</span><span class="p">,</span>
        <span class="s2">"who"</span><span class="p">,</span>
        <span class="s2">"whom"</span><span class="p">,</span>
        <span class="s2">"this"</span><span class="p">,</span>
        <span class="s2">"that"</span><span class="p">,</span>
        <span class="s2">"that'll"</span><span class="p">,</span>
        <span class="s2">"these"</span><span class="p">,</span>
        <span class="s2">"those"</span><span class="p">,</span>
        <span class="s2">"am"</span><span class="p">,</span>
        <span class="s2">"is"</span><span class="p">,</span>
        <span class="s2">"are"</span><span class="p">,</span>
        <span class="s2">"was"</span><span class="p">,</span>
        <span class="s2">"were"</span><span class="p">,</span>
        <span class="s2">"be"</span><span class="p">,</span>
        <span class="s2">"been"</span><span class="p">,</span>
        <span class="s2">"being"</span><span class="p">,</span>
        <span class="s2">"have"</span><span class="p">,</span>
        <span class="s2">"has"</span><span class="p">,</span>
        <span class="s2">"had"</span><span class="p">,</span>
        <span class="s2">"having"</span><span class="p">,</span>
        <span class="s2">"do"</span><span class="p">,</span>
        <span class="s2">"does"</span><span class="p">,</span>
        <span class="s2">"did"</span><span class="p">,</span>
        <span class="s2">"doing"</span><span class="p">,</span>
        <span class="s2">"a"</span><span class="p">,</span>
        <span class="s2">"an"</span><span class="p">,</span>
        <span class="s2">"the"</span><span class="p">,</span>
        <span class="s2">"and"</span><span class="p">,</span>
        <span class="s2">"but"</span><span class="p">,</span>
        <span class="s2">"if"</span><span class="p">,</span>
        <span class="s2">"or"</span><span class="p">,</span>
        <span class="s2">"because"</span><span class="p">,</span>
        <span class="s2">"as"</span><span class="p">,</span>
        <span class="s2">"until"</span><span class="p">,</span>
        <span class="s2">"while"</span><span class="p">,</span>
        <span class="s2">"of"</span><span class="p">,</span>
        <span class="s2">"at"</span><span class="p">,</span>
        <span class="s2">"by"</span><span class="p">,</span>
        <span class="s2">"for"</span><span class="p">,</span>
        <span class="s2">"with"</span><span class="p">,</span>
        <span class="s2">"about"</span><span class="p">,</span>
        <span class="s2">"against"</span><span class="p">,</span>
        <span class="s2">"between"</span><span class="p">,</span>
        <span class="s2">"into"</span><span class="p">,</span>
        <span class="s2">"through"</span><span class="p">,</span>
        <span class="s2">"during"</span><span class="p">,</span>
        <span class="s2">"before"</span><span class="p">,</span>
        <span class="s2">"after"</span><span class="p">,</span>
        <span class="s2">"above"</span><span class="p">,</span>
        <span class="s2">"below"</span><span class="p">,</span>
        <span class="s2">"to"</span><span class="p">,</span>
        <span class="s2">"from"</span><span class="p">,</span>
        <span class="s2">"up"</span><span class="p">,</span>
        <span class="s2">"down"</span><span class="p">,</span>
        <span class="s2">"in"</span><span class="p">,</span>
        <span class="s2">"out"</span><span class="p">,</span>
        <span class="s2">"on"</span><span class="p">,</span>
        <span class="s2">"off"</span><span class="p">,</span>
        <span class="s2">"over"</span><span class="p">,</span>
        <span class="s2">"under"</span><span class="p">,</span>
        <span class="s2">"again"</span><span class="p">,</span>
        <span class="s2">"further"</span><span class="p">,</span>
        <span class="s2">"then"</span><span class="p">,</span>
        <span class="s2">"once"</span><span class="p">,</span>
        <span class="s2">"here"</span><span class="p">,</span>
        <span class="s2">"there"</span><span class="p">,</span>
        <span class="s2">"when"</span><span class="p">,</span>
        <span class="s2">"where"</span><span class="p">,</span>
        <span class="s2">"why"</span><span class="p">,</span>
        <span class="s2">"how"</span><span class="p">,</span>
        <span class="s2">"all"</span><span class="p">,</span>
        <span class="s2">"any"</span><span class="p">,</span>
        <span class="s2">"both"</span><span class="p">,</span>
        <span class="s2">"each"</span><span class="p">,</span>
        <span class="s2">"few"</span><span class="p">,</span>
        <span class="s2">"more"</span><span class="p">,</span>
        <span class="s2">"most"</span><span class="p">,</span>
        <span class="s2">"other"</span><span class="p">,</span>
        <span class="s2">"some"</span><span class="p">,</span>
        <span class="s2">"such"</span><span class="p">,</span>
        <span class="s2">"no"</span><span class="p">,</span>
        <span class="s2">"nor"</span><span class="p">,</span>
        <span class="s2">"not"</span><span class="p">,</span>
        <span class="s2">"only"</span><span class="p">,</span>
        <span class="s2">"own"</span><span class="p">,</span>
        <span class="s2">"same"</span><span class="p">,</span>
        <span class="s2">"so"</span><span class="p">,</span>
        <span class="s2">"than"</span><span class="p">,</span>
        <span class="s2">"too"</span><span class="p">,</span>
        <span class="s2">"very"</span><span class="p">,</span>
        <span class="s2">"s"</span><span class="p">,</span>
        <span class="s2">"t"</span><span class="p">,</span>
        <span class="s2">"can"</span><span class="p">,</span>
        <span class="s2">"will"</span><span class="p">,</span>
        <span class="s2">"just"</span><span class="p">,</span>
        <span class="s2">"don"</span><span class="p">,</span>
        <span class="s2">"don't"</span><span class="p">,</span>
        <span class="s2">"should"</span><span class="p">,</span>
        <span class="s2">"should've"</span><span class="p">,</span>
        <span class="s2">"now"</span><span class="p">,</span>
        <span class="s2">"d"</span><span class="p">,</span>
        <span class="s2">"ll"</span><span class="p">,</span>
        <span class="s2">"m"</span><span class="p">,</span>
        <span class="s2">"o"</span><span class="p">,</span>
        <span class="s2">"re"</span><span class="p">,</span>
        <span class="s2">"ve"</span><span class="p">,</span>
        <span class="s2">"y"</span><span class="p">,</span>
        <span class="s2">"ain"</span><span class="p">,</span>
        <span class="s2">"aren"</span><span class="p">,</span>
        <span class="s2">"aren't"</span><span class="p">,</span>
        <span class="s2">"couldn"</span><span class="p">,</span>
        <span class="s2">"couldn't"</span><span class="p">,</span>
        <span class="s2">"didn"</span><span class="p">,</span>
        <span class="s2">"didn't"</span><span class="p">,</span>
        <span class="s2">"doesn"</span><span class="p">,</span>
        <span class="s2">"doesn't"</span><span class="p">,</span>
        <span class="s2">"hadn"</span><span class="p">,</span>
        <span class="s2">"hadn't"</span><span class="p">,</span>
        <span class="s2">"hasn"</span><span class="p">,</span>
        <span class="s2">"hasn't"</span><span class="p">,</span>
        <span class="s2">"haven"</span><span class="p">,</span>
        <span class="s2">"haven't"</span><span class="p">,</span>
        <span class="s2">"isn"</span><span class="p">,</span>
        <span class="s2">"isn't"</span><span class="p">,</span>
        <span class="s2">"ma"</span><span class="p">,</span>
        <span class="s2">"mightn"</span><span class="p">,</span>
        <span class="s2">"mightn't"</span><span class="p">,</span>
        <span class="s2">"mustn"</span><span class="p">,</span>
        <span class="s2">"mustn't"</span><span class="p">,</span>
        <span class="s2">"needn"</span><span class="p">,</span>
        <span class="s2">"needn't"</span><span class="p">,</span>
        <span class="s2">"shan"</span><span class="p">,</span>
        <span class="s2">"shan't"</span><span class="p">,</span>
        <span class="s2">"shouldn"</span><span class="p">,</span>
        <span class="s2">"shouldn't"</span><span class="p">,</span>
        <span class="s2">"wasn"</span><span class="p">,</span>
        <span class="s2">"wasn't"</span><span class="p">,</span>
        <span class="s2">"weren"</span><span class="p">,</span>
        <span class="s2">"weren't"</span><span class="p">,</span>
        <span class="s2">"won"</span><span class="p">,</span>
        <span class="s2">"won't"</span><span class="p">,</span>
        <span class="s2">"wouldn"</span><span class="p">,</span>
        <span class="s2">"wouldn't"</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""Conditional preprocessing on text.</span>

<span class="sd">    Usage:</span>

<span class="sd">    ```python</span>
<span class="sd">    preprocess(text="Transfer learning with BERT!", lower=True, stem=True)</span>
<span class="sd">    ```</span>
<span class="sd">    &lt;pre&gt;</span>
<span class="sd">    'transfer learn bert'</span>
<span class="sd">    &lt;/pre&gt;</span>

<span class="sd">    Args:</span>
<span class="sd">        text (str): String to preprocess.</span>
<span class="sd">        lower (bool, optional): Lower the text. Defaults to True.</span>
<span class="sd">        stem (bool, optional): Stem the text. Defaults to False.</span>
<span class="sd">        filters (str, optional): Filters to apply on text.</span>
<span class="sd">        stopwords (List, optional): List of words to filter out. Defaults to STOPWORDS.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Preprocessed string.</span>
<span class="sd">    """</span>
    <span class="c1"># Lower</span>
    <span class="k">if</span> <span class="n">lower</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1"># Remove stopwords</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stopwords</span><span class="p">):</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">"\b("</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">"|"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">stopwords</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">")\b\s*"</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

    <span class="c1"># Spacing and filters</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"([-;;.,!?&lt;=&gt;])"</span><span class="p">,</span> <span class="sa">r</span><span class="s2">" \1 "</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="sa">r</span><span class="s2">""</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">"[^A-Za-z0-9]+"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>  <span class="c1"># remove non alphanumeric chars</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">" +"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>  <span class="c1"># remove multiple spaces</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="c1"># Remove links</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"http\S+"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

    <span class="c1"># Stemming</span>
    <span class="k">if</span> <span class="n">stem</span><span class="p">:</span>
        <span class="n">stemmer</span> <span class="o">=</span> <span class="n">Stemmer</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stemmer</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)])</span>

    <span class="k">return</span> <span class="n">text</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../app/config/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Config
              </div>
            </div>
          </a>
        
        
          <a href="../models/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Models
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/GokuMohandas" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://linkedin.com/in/goku" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/GokuMohandas" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/madewithml?sub_confirmation=1" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
      <a href="mailto:hello@madewithml.com" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['navigation.tabs', 'navigation.expand'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>